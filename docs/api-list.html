<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>List/Library Methods (SP.List) · SpRestLib</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Syntax"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="List/Library Methods (SP.List) · SpRestLib"/><meta property="og:type" content="website"/><meta property="og:url" content="https://gitbrent.github.io/SpRestLib/index.html"/><meta property="og:description" content="## Syntax"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://gitbrent.github.io/SpRestLib/img/sprestlib.png"/><link rel="shortcut icon" href="/SpRestLib/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/hybrid.min.css"/><link rel="alternate" type="application/atom+xml" href="https://gitbrent.github.io/SpRestLib/blog/atom.xml" title="SpRestLib Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://gitbrent.github.io/SpRestLib/blog/feed.xml" title="SpRestLib Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-75147115-3', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script><link rel="stylesheet" href="/SpRestLib/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/SpRestLib/"><img class="logo" src="/SpRestLib/img/sprestlib.svg" alt="SpRestLib"/><h2 class="headerTitleWithLogo">SpRestLib</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://github.com/gitbrent/SpRestLib/releases" target="_self">Download</a></li><li class="siteNavGroupActive"><a href="/SpRestLib/docs/installation.html" target="_self">Get Started</a></li><li class="siteNavGroupActive siteNavItemActive"><a href="/SpRestLib/docs/api-list.html" target="_self">API Documentation</a></li><li class=""><a href="/SpRestLib/blog" target="_self">SharePoint Guides</a></li><li class=""><a href="https://github.com/gitbrent/SpRestLib/" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>API Reference</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Get Started</h3><ul><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/installation.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/promises.html">Promise You Will Love It</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Features</h3><ul><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/feat-integration.html">Library Integration</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/feat-promises.html">Promise-based Operations</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/feat-node.html">SharePoint via Node.js</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/feat-utilities.html">Utility Methods</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API Reference</h3><ul><li class="navListItem navListItemActive"><a class="navItem" href="/SpRestLib/docs/api-list.html">List/Library Methods (SP.List)</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/api-file.html">File Methods (SP.File)</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/api-folder.html">Folder Methods (SP.Folder)</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/api-site.html">Site Methods (SP.Web)</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/api-user.html">User Methods (SP.User)</a></li><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/api-rest.html">REST API Methods</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">SpRestLib UI</h3><ul><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/ui-form-binding.html">Form Binding</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Help / Support</h3><ul><li class="navListItem"><a class="navItem" href="/SpRestLib/docs/sp-auth-notes.html">SharePoint Authentication</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">List/Library Methods (SP.List)</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="syntax"></a><a href="#syntax" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Syntax</h2>
<p>Lists can be accessed by either their name or their GUID:</p>
<p><code>sprLib.list(listName)</code>  <br>
<code>sprLib.list(listGUID)</code>  <br>
<code>sprLib.list({ name:name })</code>  <br>
<code>sprLib.list({ guid:GUID })</code>  <br>
<code>sprLib.list({ name:name, baseUrl:path, requestDigest:formDigestValue })</code></p>
<h2><a class="anchor" aria-hidden="true" id="options"></a><a href="#options" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Options</h2>
<table>
<thead>
<tr><th style="text-align:left">Prop</th><th style="text-align:left">Type</th><th style="text-align:left">Required?</th><th style="text-align:left">Description</th><th style="text-align:left">Possible Values</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>name</code></td><td style="text-align:left">string</td><td style="text-align:left">Y</td><td style="text-align:left">list name or list GUID</td><td style="text-align:left">Ex:<code>{'name': 'Employees'}</code></td></tr>
<tr><td style="text-align:left"><code>guid</code></td><td style="text-align:left">string</td><td style="text-align:left"></td><td style="text-align:left">list GUID (convenience alias for name)</td><td style="text-align:left">Ex:<code>{'guid': '8675309-ab3d-ef87b08e09e1'}</code></td></tr>
<tr><td style="text-align:left"><code>baseUrl</code></td><td style="text-align:left">string</td><td style="text-align:left"></td><td style="text-align:left">the base url</td><td style="text-align:left">Ex:<code>{'baseUrl': '/sites/dev'}</code></td></tr>
<tr><td style="text-align:left"><code>requestDigest</code></td><td style="text-align:left">string</td><td style="text-align:left"></td><td style="text-align:left">the request form digest security token</td><td style="text-align:left">Ex:<code>{'requestDigest': 'ABC123'}</code></td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="options-baseurl"></a><a href="#options-baseurl" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Options: baseUrl</h3>
<p>By default, the base URL is set to where the host webpart is located (<code>_spPageContextInfo.webServerRelativeUrl</code>).
However, there are occasions when reading from other locations - like a subsite - is desired. Use the <code>baseUrl</code>
parameter to specify the desired location.</p>
<h3><a class="anchor" aria-hidden="true" id="options-requestdigest"></a><a href="#options-requestdigest" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Options: requestDigest</h3>
<p>By default, the request digest is set to the <code>&lt;input id=&quot;__REQUESTDIGEST&quot;&gt;</code> form element value if one exists (e.g.: WebPart in an .aspx page).
Security tokens are required for certain SharePoint operations like creating or updating List items. If your application is not inside
a SharePoint .aspx page, you will need to obtain the digest value and pass it when it's needed.</p>
<p>Example: How to obtain a FormDigestValue</p>
<pre><code class="hljs css language-javascript">sprLib.rest({ <span class="hljs-attr">url</span>:<span class="hljs-string">'_api/contextinfo'</span>, <span class="hljs-attr">type</span>:<span class="hljs-string">'POST'</span> })
.then(<span class="hljs-function"><span class="hljs-params">arr</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(arr[<span class="hljs-number">0</span>].GetContextWebInformation.FormDigestValue) );
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="get-items"></a><a href="#get-items" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get Items</h2>
<p>Syntax:<br>
<code>sprLib.list(listName|listGUID).items(options)</code></p>
<p>Returns:</p>
<ul>
<li>Array of objects containing column name/value pairs</li>
</ul>
<p>Notes:</p>
<ul>
<li>Omitting the <code>listCols</code> option will result in all List columns being returned (mimics SharePoint default behavior)</li>
<li>Only the first 100 items are returned by default (mimics SharePoint default behavior) - use <code>queryLimit</code> to get more (5,000 is typically the max, use <code>queryNext</code> [paging] for unlimited items)</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="items-options"></a><a href="#items-options" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>items Options</h3>
<table>
<thead>
<tr><th style="text-align:left">Option</th><th style="text-align:left">Type</th><th style="text-align:left">Default</th><th style="text-align:left">Description</th><th style="text-align:left">Possible Values / Returns</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>listCols</code></td><td style="text-align:left">array</td><td style="text-align:left"></td><td style="text-align:left">array of column names (OData style)</td><td style="text-align:left"><code>listCols: ['Name', 'Badge_x0020_Number']</code></td></tr>
<tr><td style="text-align:left"><code>listCols</code></td><td style="text-align:left">object</td><td style="text-align:left"></td><td style="text-align:left">object with column properties</td><td style="text-align:left"><code>listCols: { badge: { dataName:'Badge_x0020_Number' } }</code></td></tr>
<tr><td style="text-align:left"><code>cache</code></td><td style="text-align:left">boolean</td><td style="text-align:left"><code>false</code></td><td style="text-align:left">cache settings</td><td style="text-align:left">Ex:<code>cache: true</code></td></tr>
<tr><td style="text-align:left"><code>queryFilter</code></td><td style="text-align:left">string</td><td style="text-align:left"></td><td style="text-align:left">query filter</td><td style="text-align:left">utilizes OData style <a href="https://msdn.microsoft.com/en-us/library/office/fp142385.aspx#Anchor_7">Query Operators</a></td></tr>
<tr><td style="text-align:left"><code>queryLimit</code></td><td style="text-align:left">string</td><td style="text-align:left"></td><td style="text-align:left">max items to return</td><td style="text-align:left">1-<em>N</em></td></tr>
<tr><td style="text-align:left"><code>queryNext</code></td><td style="text-align:left">object</td><td style="text-align:left"></td><td style="text-align:left">object with Next/Skip options (paging)</td><td style="text-align:left"><code>prevId</code> (1-N), <code>maxItems</code> (1-5000) Ex:<code>{ prevId:5000, maxItems:1000 }</code></td></tr>
<tr><td style="text-align:left"><code>queryOrderby</code></td><td style="text-align:left">string</td><td style="text-align:left"></td><td style="text-align:left">column(s) to order by</td><td style="text-align:left">Ex:<code>queryOrderby:Name</code></td></tr>
<tr><td style="text-align:left"><code>metadata</code></td><td style="text-align:left">boolean</td><td style="text-align:left"><code>false</code></td><td style="text-align:left">whether to return <code>__metadata</code></td><td style="text-align:left">The <code>__metadata</code> property can be included in the results array (to enable further operations, use of Etag, etc.) by using <code>metadata:true</code></td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="listcols-object"></a><a href="#listcols-object" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>listCols Object</h3>
<table>
<thead>
<tr><th style="text-align:left">Option</th><th style="text-align:left">Type</th><th style="text-align:left">Default</th><th style="text-align:left">Description</th><th style="text-align:left">Possible Values / Return Values</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>dataName</code></td><td style="text-align:left">string</td><td style="text-align:left"></td><td style="text-align:left">the column name</td><td style="text-align:left">the fixed, back-end REST column name (use <a href="#get-list-column-properties">Get List Column Properties</a>)</td></tr>
<tr><td style="text-align:left"><code>dispName</code></td><td style="text-align:left">string</td><td style="text-align:left"></td><td style="text-align:left">the name to use when displaying results in table headers, etc.</td><td style="text-align:left"></td></tr>
<tr><td style="text-align:left"><code>dateFormat</code></td><td style="text-align:left">string</td><td style="text-align:left"></td><td style="text-align:left">format to use when returning/displaying date</td><td style="text-align:left"><code>INTL</code>, <code>INTLTIME</code>, <code>YYYYMMDD</code>, <code>ISO</code>, <code>US</code></td></tr>
<tr><td style="text-align:left"><code>dataFunc</code></td><td style="text-align:left">function</td><td style="text-align:left"></td><td style="text-align:left">function to use for returning a result</td><td style="text-align:left">use a custom function to transform the query result (see below)</td></tr>
<tr><td style="text-align:left"><code>getVersions</code></td><td style="text-align:left">boolean</td><td style="text-align:left"><code>false</code></td><td style="text-align:left">return append text versions in array</td><td style="text-align:left"><code>true</code> or <code>false</code></td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="listcols-datafunc-option"></a><a href="#listcols-datafunc-option" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>listCols dataFunc Option</h3>
<p>There are many times where you'll need more than a simple column value.  For example, providing a link to the InfoPath
form so users can edit the item directly.</p>
<p>The <code>dataFunc</code> option allows you access to the entire result set, then return any type of value.  See the sample below where
an &quot;editLink&quot; is created.</p>
<h3><a class="anchor" aria-hidden="true" id="sample-code"></a><a href="#sample-code" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sample Code</h3>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// EX: Simple array of column names</span>
sprLib.list(<span class="hljs-string">'Employees'</span>).items( [<span class="hljs-string">'Id'</span>,<span class="hljs-string">'Name'</span>,<span class="hljs-string">'Badge_x0020_Number'</span>] )
.then(<span class="hljs-function"><span class="hljs-params">arrData</span> =&gt;</span> <span class="hljs-built_in">console</span>.table(arrData))
.catch(<span class="hljs-function"><span class="hljs-params">errMsg</span> =&gt;</span> <span class="hljs-built_in">console</span>.error(errMsg));

<span class="hljs-comment">// Result:</span>
<span class="hljs-comment">/*
.---------------------------------------.
| Id  |    Name    | Badge_x0020_Number |
|-----|------------|--------------------|
| 253 | Hal Jordan |              12345 |
'---------------------------------------'
*/</span>
</code></pre>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// EX: Using 'listCols' option with array of column names</span>
sprLib.list(<span class="hljs-string">'Employees'</span>).items({
    <span class="hljs-attr">listCols</span>: [<span class="hljs-string">'Name'</span>, <span class="hljs-string">'Badge_x0020_Number'</span>, <span class="hljs-string">'Hire_x0020_Date'</span>]
})
.then(<span class="hljs-function"><span class="hljs-params">arrData</span> =&gt;</span> <span class="hljs-built_in">console</span>.table(arrData))
.catch(<span class="hljs-function"><span class="hljs-params">errMsg</span> =&gt;</span> <span class="hljs-built_in">console</span>.error(errMsg));
</code></pre>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// EX: Using 'listCols' option to name our columns</span>
<span class="hljs-comment">// EX: Using 'getVersions' to gather all "Append Text"/Versioned Text into an array</span>
<span class="hljs-comment">// EX: Using 'dataFunc' option to return a dynamic, generated value (an html link)</span>
<span class="hljs-comment">// EX: Using query options: filter, order, limit</span>
sprLib.list(<span class="hljs-string">'Employees'</span>).items({
    <span class="hljs-attr">listCols</span>: {
        <span class="hljs-attr">empId</span>:      { <span class="hljs-attr">dataName</span>:<span class="hljs-string">'ID'</span> },
        <span class="hljs-attr">badgeNum</span>:   { <span class="hljs-attr">dataName</span>:<span class="hljs-string">'Badge_x0020_Number'</span> },
        <span class="hljs-attr">appendText</span>: { <span class="hljs-attr">dataName</span>:<span class="hljs-string">'Versioned_x0020_Comments'</span>, <span class="hljs-attr">getVersions</span>:<span class="hljs-literal">true</span> },
        <span class="hljs-attr">viewLink</span>:   { <span class="hljs-attr">dataFunc</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">objItem</span>)</span>{ <span class="hljs-keyword">return</span> <span class="hljs-string">'&lt;a href="/sites/dev/Lists/Employees/DispForm.aspx?ID='</span>+objItem.ID+<span class="hljs-string">'"&gt;View Emp&lt;/a&gt;'</span> } }
    },
    <span class="hljs-attr">queryFilter</span>:  <span class="hljs-string">'Salary gt 100000'</span>,
    <span class="hljs-attr">queryOrderby</span>: <span class="hljs-string">'Hire_x0020_Date'</span>,
    <span class="hljs-attr">queryLimit</span>:   <span class="hljs-number">3</span>
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arrData</span>)</span>{ <span class="hljs-built_in">console</span>.table(arrData) })
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">errMsg</span>)</span>{ <span class="hljs-built_in">console</span>.error(errMsg) });

<span class="hljs-comment">// RESULT:</span>
<span class="hljs-comment">/*
.--------------------------------------------------------------------------------------------------------------------------------.
| empId | badgeNum |            appendText              |                                viewLink                                |
|-------|----------|------------------------------------|------------------------------------------------------------------------|
|   334 |  1497127 | ["20170624:Update","20170601:New"] | &lt;a href="/sites/dev/Lists/Employees/DispForm.aspx?ID=334"&gt;View Emp&lt;/a&gt; |
|   339 |  1497924 | ["Not here yet", "Emp created"]    | &lt;a href="/sites/dev/Lists/Employees/DispForm.aspx?ID=339"&gt;View Emp&lt;/a&gt; |
|   350 |  1497927 | ["Vice President promotion"]       | &lt;a href="/sites/dev/Lists/Employees/DispForm.aspx?ID=350"&gt;View Emp&lt;/a&gt; |
'--------------------------------------------------------------------------------------------------------------------------------'
*/</span>
</code></pre>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">// EX: Using paging/next/skip</span>

<span class="hljs-comment">// Anytime there are more results than what was returned, an `__next` object will be included. Keep passing these in subsequent queries to get all results.</span>
sprLib.list(<span class="hljs-string">'Departments'</span>).items({ <span class="hljs-attr">listCols</span>:[<span class="hljs-string">'Id'</span>,<span class="hljs-string">'Created'</span>], <span class="hljs-attr">queryLimit</span>:<span class="hljs-number">5</span> });
<span class="hljs-comment">// RESULT:</span>
<span class="hljs-comment">/*
.-----------------------------------------------------------.
|            __next             | Id |       Created        |
|-------------------------------|----|----------------------|
| {"prevId":"5","maxItems":"5"} |  1 | 2016-12-04T21:58:47Z |
| {"prevId":"5","maxItems":"5"} |  2 | 2016-12-04T21:59:07Z |
| {"prevId":"5","maxItems":"5"} |  3 | 2016-12-04T21:59:20Z |
| {"prevId":"5","maxItems":"5"} |  4 | 2016-12-04T21:59:36Z |
| {"prevId":"5","maxItems":"5"} |  5 | 2016-12-04T21:59:49Z |
'-----------------------------------------------------------'
*/</span>

sprLib.list(<span class="hljs-string">'Departments'</span>).items({
    <span class="hljs-attr">listCols</span>:  [<span class="hljs-string">'Id'</span>,<span class="hljs-string">'Created'</span>],
    <span class="hljs-attr">queryNext</span>: {<span class="hljs-string">'prevId'</span>:<span class="hljs-number">5</span>, <span class="hljs-string">'maxItems'</span>:<span class="hljs-number">5</span>}
});
<span class="hljs-comment">// RESULT:</span>
<span class="hljs-comment">/*
.------------------------------------------------------------.
|             __next             | Id |       Created        |
|--------------------------------|----|----------------------|
| {"prevId":"10","maxItems":"5"} |  6 | 2017-06-01T03:19:01Z |
| {"prevId":"10","maxItems":"5"} |  7 | 2017-12-14T05:00:10Z |
| {"prevId":"10","maxItems":"5"} |  8 | 2017-12-14T05:00:34Z |
| {"prevId":"10","maxItems":"5"} |  9 | 2017-12-14T05:00:59Z |
| {"prevId":"10","maxItems":"5"} | 10 | 2017-12-14T05:01:15Z |
'------------------------------------------------------------'
*/</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="create-item"></a><a href="#create-item" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create Item</h2>
<p>Syntax: <code>sprLib.list(listName|listGUID).create(itemObject)</code></p>
<p>Options: An object with internal name/value pairs to be inserted</p>
<p>Returns: Object with column name/value pairs</p>
<p>Example:</p>
<pre><code class="hljs css language-javascript">sprLib.list(<span class="hljs-string">'Employees'</span>)
.create({
    <span class="hljs-attr">Name</span>: <span class="hljs-string">'Marty McFly'</span>,
    <span class="hljs-attr">Badge_x0020_Number</span>: <span class="hljs-number">12345</span>,
    <span class="hljs-attr">Hire_x0020_Date</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(),
    <span class="hljs-attr">Active</span>: <span class="hljs-literal">true</span>
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">objItem</span>)</span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New Item:'</span>);
    <span class="hljs-built_in">console</span>.table(objItem);
})
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">strErr</span>)</span>{ <span class="hljs-built_in">console</span>.error(strErr); });
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="update-item"></a><a href="#update-item" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Update Item</h2>
<p>Syntax:
<code>sprLib.list(listName|listGUID).update(itemObject)</code></p>
<p>Options:</p>
<ul>
<li>An object with internal name/value pairs to be inserted</li>
<li>if <code>__metadata.etag</code> is not provided, this is equivalent to force:true (<code>etag:'&quot;*&quot;'</code> is used)</li>
</ul>
<p>Returns:
The object provided</p>
<p>Example:</p>
<pre><code class="hljs css language-javascript">sprLib.list(<span class="hljs-string">'Employees'</span>)
.update({
    <span class="hljs-attr">ID</span>: <span class="hljs-number">99</span>,
    <span class="hljs-attr">Name</span>: <span class="hljs-string">'Marty McFly'</span>,
    <span class="hljs-attr">Active</span>: <span class="hljs-literal">false</span>
})
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">objItem</span>)</span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Updated Item:'</span>);
    <span class="hljs-built_in">console</span>.table(objItem);
})
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">strErr</span>)</span>{ <span class="hljs-built_in">console</span>.error(strErr); });
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="delete-item"></a><a href="#delete-item" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Delete Item</h2>
<p>Syntax:
<code>sprLib.list(listName|listGUID).delete(itemObject)</code></p>
<p>Returns:
ID of the item just deleted</p>
<p>Notes:
Permanently deletes the item (bypasses Recycle Bin - not recoverable)</p>
<p>Example:</p>
<pre><code class="hljs css language-javascript">sprLib.list(<span class="hljs-string">'Employees'</span>).delete({ <span class="hljs-string">"ID"</span>:<span class="hljs-number">123</span> })
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">intId</span>)</span>{ <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Deleted Item #'</span>+intId); })
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">strErr</span>)</span>{ <span class="hljs-built_in">console</span>.error(strErr); });
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="recycle-item"></a><a href="#recycle-item" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Recycle Item</h2>
<p>Syntax:
<code>sprLib.list(listName|listGUID).recycle(itemObject)</code></p>
<p>Returns:
ID of the item just recycled</p>
<p>Notes:
Moves the item into the Site Recycle Bin</p>
<p>Example:</p>
<pre><code class="hljs css language-javascript">sprLib.list(<span class="hljs-string">'Employees'</span>).recycle({ <span class="hljs-string">"ID"</span>:<span class="hljs-number">123</span> })
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">intId</span>)</span>{ <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Recycled Item #'</span>+intId); })
.catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">strErr</span>)</span>{ <span class="hljs-built_in">console</span>.error(strErr); });
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="get-list-column-properties"></a><a href="#get-list-column-properties" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get List Column Properties</h2>
<p>Syntax:
<code>sprLib.list(listName|listGUID).cols()</code></p>
<p>Returns: Array of columns with name value pairs of property values</p>
<h3><a class="anchor" aria-hidden="true" id="column-properties"></a><a href="#column-properties" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Column Properties</h3>
<table>
<thead>
<tr><th style="text-align:left">Property</th><th style="text-align:left">Type</th><th style="text-align:left">Description</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>dispName</code></td><td style="text-align:left">string</td><td style="text-align:left">display name</td></tr>
<tr><td style="text-align:left"><code>dataName</code></td><td style="text-align:left">string</td><td style="text-align:left">internal name - used in REST queries and in <code>listCols</code> arguments</td></tr>
<tr><td style="text-align:left"><code>dataType</code></td><td style="text-align:left">string</td><td style="text-align:left">column type (FieldTypeKind) value (ex: <code>Boolean</code>, <code>DateTime</code>, <code>Text</code>)</td></tr>
<tr><td style="text-align:left"><code>defaultValue</code></td><td style="text-align:left">boolean</td><td style="text-align:left">the default value (if any)</td></tr>
<tr><td style="text-align:left"><code>isAppend</code></td><td style="text-align:left">boolean</td><td style="text-align:left">is this an append text column?</td></tr>
<tr><td style="text-align:left"><code>isNumPct</code></td><td style="text-align:left">boolean</td><td style="text-align:left">is this a percentage number column?</td></tr>
<tr><td style="text-align:left"><code>isReadOnly</code></td><td style="text-align:left">boolean</td><td style="text-align:left">is this an read only column?</td></tr>
<tr><td style="text-align:left"><code>isRequired</code></td><td style="text-align:left">boolean</td><td style="text-align:left">is a value required in this column?</td></tr>
<tr><td style="text-align:left"><code>isUnique</code></td><td style="text-align:left">boolean</td><td style="text-align:left">are unique values enforced on this column?</td></tr>
<tr><td style="text-align:left"><code>maxLength</code></td><td style="text-align:left">boolean</td><td style="text-align:left">the maximum length of the column value</td></tr>
<tr><td style="text-align:left"><code>choiceValues</code></td><td style="text-align:left">array</td><td style="text-align:left">allowed choice values</td></tr>
<tr><td style="text-align:left"><code>allowFillInChoices</code></td><td style="text-align:left">boolean</td><td style="text-align:left">are fill-in (custom) choices allowed?</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="sample-code-1"></a><a href="#sample-code-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sample Code</h3>
<pre><code class="hljs css language-javascript">sprLib.list(<span class="hljs-string">'Announcements'</span>).cols()
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arrayResults</span>)</span>{ <span class="hljs-built_in">console</span>.table(arrayResults) });

<span class="hljs-comment">// Result:</span>
<span class="hljs-comment">/*
.---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------.
|      dispName       |     dataName      |  dataType   | isAppend | isNumPct | isReadOnly | isRequired | isUnique | defaultValue | maxLength | choiceValues | allowFillInChoices |
|---------------------|-------------------|-------------|----------|----------|------------|------------|----------|--------------|-----------|--------------|--------------------|
| ID                  | ID                | Counter     | false    | false    | true       | false      | false    | null         | null      | null         | null               |
| Content Type        | ContentType       | Computed    | false    | false    | false      | false      | false    | null         | null      | null         | null               |
| Title               | Title             | Text        | false    | false    | false      | true       | false    | null         |       255 | null         | null               |
| Modified            | Modified          | DateTime    | false    | false    | true       | false      | false    | null         | null      | null         | null               |
| Created             | Created           | DateTime    | false    | false    | true       | false      | false    | null         | null      | null         | null               |
| Created By          | Author            | User        | false    | false    | true       | false      | false    | null         | null      | null         | null               |
| Modified By         | Editor            | User        | false    | false    | true       | false      | false    | null         | null      | null         | null               |
| Attachments         | Attachments       | Attachments | false    | false    | false      | false      | false    | null         | null      | null         | null               |
| Title               | LinkTitleNoMenu   | Computed    | false    | false    | true       | false      | false    | null         | null      | null         | null               |
| Title               | LinkTitle         | Computed    | false    | false    | true       | false      | false    | null         | null      | null         | null               |
| Item Child Count    | ItemChildCount    | Lookup      | false    | false    | true       | false      | false    | null         | null      | null         | null               |
| Folder Child Count  | FolderChildCount  | Lookup      | false    | false    | true       | false      | false    | null         | null      | null         | null               |
| App Created By      | AppAuthor         | Lookup      | false    | false    | true       | false      | false    | null         | null      | null         | null               |
| App Modified By     | AppEditor         | Lookup      | false    | false    | true       | false      | false    | null         | null      | null         | null               |
| Compliance Asset Id | ComplianceAssetId | Text        | false    | false    | true       | false      | false    | null         |       255 | null         | null               |
| Body                | Body              | Note        | false    | false    | false      | false      | false    | null         | null      | null         | null               |
| Expires             | Expires           | DateTime    | false    | false    | false      | false      | false    | null         | null      | null         | null               |
| Status              | Status            | Choice      | false    | false    | false      | false      | false    | null         | null      | [1, 2, 3, 4] | false              |
'---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
*/</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="get-list-info"></a><a href="#get-list-info" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get List Info</h2>
<p>Syntax: <code>sprLib.list(listName|listGUID).info()</code></p>
<p>Returns: Object containing list properties</p>
<h3><a class="anchor" aria-hidden="true" id="list-properties"></a><a href="#list-properties" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>List Properties</h3>
<table>
<thead>
<tr><th style="text-align:left">Property Name</th><th style="text-align:left">Type</th><th style="text-align:left">Description</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>AllowContentTypes</code></td><td style="text-align:left">boolean</td><td style="text-align:left">Whether <code>Allow management of content types?</code> is enabled</td></tr>
<tr><td style="text-align:left"><code>BaseTemplate</code></td><td style="text-align:left">integer</td><td style="text-align:left"><code>SPListTemplateType</code> SP Base Template ID number - ex: <code>100</code></td></tr>
<tr><td style="text-align:left"><code>BaseType</code></td><td style="text-align:left">integer</td><td style="text-align:left">SP Base Type ID number - ex: <code>0</code></td></tr>
<tr><td style="text-align:left"><code>Created</code></td><td style="text-align:left">string</td><td style="text-align:left">Date the List/Library was created (ISO format)</td></tr>
<tr><td style="text-align:left"><code>Description</code></td><td style="text-align:left">string</td><td style="text-align:left">List/Library <code>Description</code></td></tr>
<tr><td style="text-align:left"><code>DraftVersionVisibility</code></td><td style="text-align:left">number</td><td style="text-align:left">whether draft versions can be seen</td></tr>
<tr><td style="text-align:left"><code>EnableAttachments</code></td><td style="text-align:left">boolean</td><td style="text-align:left">whether users can attach files to items in this list</td></tr>
<tr><td style="text-align:left"><code>EnableFolderCreation</code></td><td style="text-align:left">boolean</td><td style="text-align:left">whether users can create folders in this list/library</td></tr>
<tr><td style="text-align:left"><code>EnableVersioning</code></td><td style="text-align:left">boolean</td><td style="text-align:left">whether versioning is enabled for the items in this list</td></tr>
<tr><td style="text-align:left"><code>ForceCheckout</code></td><td style="text-align:left">boolean</td><td style="text-align:left">Whether Force checkout is enabled</td></tr>
<tr><td style="text-align:left"><code>HasUniqueRoleAssignments</code></td><td style="text-align:left">boolean</td><td style="text-align:left">Whether list has unique (non-inherited) permissions</td></tr>
<tr><td style="text-align:left"><code>Hidden</code></td><td style="text-align:left">boolean</td><td style="text-align:left">Whether List is hidden</td></tr>
<tr><td style="text-align:left"><code>Id</code></td><td style="text-align:left">GUID</td><td style="text-align:left">The SP GUID of the List</td></tr>
<tr><td style="text-align:left"><code>ItemCount</code></td><td style="text-align:left">number</td><td style="text-align:left">The number of Items in the List</td></tr>
<tr><td style="text-align:left"><code>LastItemDeletedDate</code></td><td style="text-align:left">string</td><td style="text-align:left">Date (ISO format) an item was last deleted</td></tr>
<tr><td style="text-align:left"><code>LastItemModifiedDate</code></td><td style="text-align:left">string</td><td style="text-align:left">Date (ISO format) an item was last modified</td></tr>
<tr><td style="text-align:left"><code>LastItemUserModifiedDate</code></td><td style="text-align:left">string</td><td style="text-align:left">Date (ISO format) an item was last modified by a User</td></tr>
<tr><td style="text-align:left"><code>ListItemEntityTypeFullName</code></td><td style="text-align:left">string</td><td style="text-align:left"><code>SP.List.listItemEntityTypeFullName</code> property</td></tr>
<tr><td style="text-align:left"><code>Title</code></td><td style="text-align:left">string</td><td style="text-align:left">The Title of the List/Library</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="sample-code-2"></a><a href="#sample-code-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sample Code</h3>
<pre><code class="hljs css language-javascript">sprLib.list(<span class="hljs-string">'Employees'</span>).info()
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">object</span>)</span>{ <span class="hljs-built_in">console</span>.table([object]) });

<span class="hljs-comment">// RESULT:</span>
<span class="hljs-comment">/*
.---------------------------------------------------------------------.
|         Prop Name          |               Prop Value               |
|----------------------------|----------------------------------------|
| AllowContentTypes          | true                                   |
| BaseTemplate               | 100                                    |
| BaseType                   | 0                                      |
| Created                    | "2017-08-21T20:48:43Z"                 |
| Description                |                                        |
| DraftVersionVisibility     | 0                                      |
| EnableAttachments          | true                                   |
| EnableFolderCreation       | false                                  |
| EnableVersioning           | true                                   |
| ForceCheckout              | false                                  |
| HasUniqueRoleAssignments   | false                                  |
| Hidden                     | false                                  |
| Id                         | "8fda2799-dbbc-a420-9869-df87b08b09c1" |
| ItemCount                  | 238                                    |
| LastItemDeletedDate        | "2017-10-27T04:42:39Z"                 |
| LastItemModifiedDate       | "2017-10-27T04:42:55Z"                 |
| LastItemUserModifiedDate   | "2017-10-27T04:42:55Z"                 |
| ListItemEntityTypeFullName | "SP.Data.EmployeesListItem"            |
| Title                      | "Employees"                            |
'---------------------------------------------------------------------'
*/</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="get-list-permissions"></a><a href="#get-list-permissions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Get List Permissions</h2>
<p>Syntax: <code>sprLib.list(listName|listGUID).perms()</code></p>
<p>Returns: Array of list permissions</p>
<h3><a class="anchor" aria-hidden="true" id="perm-properties"></a><a href="#perm-properties" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Perm Properties</h3>
<table>
<thead>
<tr><th style="text-align:left">Property Name</th><th style="text-align:left">Type</th><th style="text-align:left">Description</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>Member</code></td><td style="text-align:left">object</td><td style="text-align:left">object with Member properties (<code>Title</code>,<code>PrincipalId</code>,<code>PrincipalType</code>)</td></tr>
<tr><td style="text-align:left"><code>Roles</code></td><td style="text-align:left">object</td><td style="text-align:left">array of Role objects with properties: (<code>Name</code>,<code>Hidden</code>)</td></tr>
</tbody>
</table>
<h3><a class="anchor" aria-hidden="true" id="sample-code-3"></a><a href="#sample-code-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sample Code</h3>
<pre><code class="hljs css language-javascript">sprLib.list(<span class="hljs-string">'Employees'</span>).perms()
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arrayResults</span>)</span>{ <span class="hljs-built_in">console</span>.table(arrayResults) });

<span class="hljs-comment">/*
.-----------------------------------------------------------------------------------------------------------------------------------------------------------.
|                                        Member                                         |                               Roles                               |
|---------------------------------------------------------------------------------------|-------------------------------------------------------------------|
| {"Title":"Dev Site Members","PrincipalType":"SharePoint Group","PrincipalId":8}       | [{"Hidden":false,"Name":"Design"},{"Hidden":false,"Name":"Edit"}] |
| {"Title":"Dev Site Owners","PrincipalType":"SharePoint Group","PrincipalId":6}        | [{"Hidden":false,"Name":"Full Control"}]                          |
| {"Title":"Dev Site Visitors","PrincipalType":"SharePoint Group","PrincipalId":7}      | [{"Hidden":false,"Name":"Read"}]                                  |
| {"Title":"Excel Services Viewers","PrincipalType":"SharePoint Group","PrincipalId":5} | [{"Hidden":false,"Name":"View Only"}]                             |
'-----------------------------------------------------------------------------------------------------------------------------------------------------------'
*/</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="list-permissions-page-useraspx"></a><a href="#list-permissions-page-useraspx" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>List Permissions page (user.aspx)</h3>
<p>Easily reproduce the &quot;List Permissions&quot; page ('/_layouts/15/user.aspx')</p>
<pre><code class="hljs css language-javascript">sprLib.list(<span class="hljs-string">'Employees'</span>).perms()
.then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arrPerms</span>)</span>{
    arrPerms.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">perm</span>)</span>{
        <span class="hljs-keyword">var</span> $row = $(<span class="hljs-string">'&lt;tr/&gt;'</span>);
        $row.append(<span class="hljs-string">'&lt;td&gt;&lt;a href="../_layouts/15/people.aspx?MembershipGroupId='</span>+ perm.Member.PrincipalId +<span class="hljs-string">'"&gt;'</span>+ perm.Member.Title +<span class="hljs-string">'&lt;/a&gt;&lt;/td&gt;'</span>);
        $row.append(<span class="hljs-string">'&lt;td&gt;'</span>+ perm.Member.PrincipalType +<span class="hljs-string">'&lt;/td&gt;'</span>);
        $row.append(<span class="hljs-string">'&lt;td/&gt;'</span>);
        perm.Roles.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">role</span>)</span>{ <span class="hljs-keyword">if</span> ( !role.Hidden ) $row.find(<span class="hljs-string">'td:last-child'</span>).append(role.Name); });
        $(<span class="hljs-string">'#tabListPerms tbody'</span>).append( $row );
    });
});

<span class="hljs-comment">/*
.----------------------------------------------------------.
|          Name          |      Type        |    Roles     |
|------------------------|------------------|--------------|
| Dev Site Members       | SharePoint Group | Design, Edit |
| Dev Site Owners        | SharePoint Group | Full Control |
| Dev Site Visitors      | SharePoint Group | Read         |
| Excel Services Viewers | SharePoint Group | View Only    |
'----------------------------------------------------------'
*/</span>
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/SpRestLib/docs/feat-utilities.html">← Utility Methods</a><a class="docs-next button" href="/SpRestLib/docs/api-file.html">File Methods (SP.File) →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#syntax">Syntax</a></li><li><a href="#options">Options</a><ul class="toc-headings"><li><a href="#options-baseurl">Options: baseUrl</a></li><li><a href="#options-requestdigest">Options: requestDigest</a></li></ul></li><li><a href="#get-items">Get Items</a><ul class="toc-headings"><li><a href="#items-options">items Options</a></li><li><a href="#listcols-object">listCols Object</a></li><li><a href="#listcols-datafunc-option">listCols dataFunc Option</a></li><li><a href="#sample-code">Sample Code</a></li></ul></li><li><a href="#create-item">Create Item</a></li><li><a href="#update-item">Update Item</a></li><li><a href="#delete-item">Delete Item</a></li><li><a href="#recycle-item">Recycle Item</a></li><li><a href="#get-list-column-properties">Get List Column Properties</a><ul class="toc-headings"><li><a href="#column-properties">Column Properties</a></li><li><a href="#sample-code-1">Sample Code</a></li></ul></li><li><a href="#get-list-info">Get List Info</a><ul class="toc-headings"><li><a href="#list-properties">List Properties</a></li><li><a href="#sample-code-2">Sample Code</a></li></ul></li><li><a href="#get-list-permissions">Get List Permissions</a><ul class="toc-headings"><li><a href="#perm-properties">Perm Properties</a></li><li><a href="#sample-code-3">Sample Code</a></li><li><a href="#list-permissions-page-useraspx">List Permissions page (user.aspx)</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/SpRestLib/" class="nav-home"><img src="/SpRestLib/img/sprestlib.svg" alt="SpRestLib" width="66" height="58"/></a><div><h5>Docs</h5><a href="/SpRestLib/docs/installation.html">Getting Started with SpRestLib</a><a href="/SpRestLib/docs/api-rest.html">SharePoint API Reference</a><a href="/SpRestLib/blog">SharePoint Development Guides</a><a href="/SpRestLib/docs/feat-promises.html">About JavaScript Promises</a></div><div><h5>Community</h5><a href="https://fb.me/sprestlib" target="_blank">Facebook</a><a href="https://twitter.com/SpRestLib" target="_blank">Twitter</a><a href="https://www.pinterest.com/sprestlib/" target="_blank">Pinterest</a><a href="https://www.youtube.com/channel/UCxZcCampOHn-47kvtcK_oVQ" target="_blank">YouTube Channel</a></div><div><h5>More</h5><a href="https://github.com/gitbrent/sprestlib/issues" target="_blank">GitHub Issues</a><a href="https://github.com/gitbrent/sprestlib" target="_blank">GitHub Project</a><a href="https://stackoverflow.com/questions/tagged/sprestlib" target="_blank">SpRestLib on Stack Overflow</a><a href="https://www.flaticon.com/packs/creativity" target="_blank">Site Icons</a></div></section><section class="copyright">Copyright © 2018 Brent Ely</section></footer></div><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script></body></html>