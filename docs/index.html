<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
	<meta name="author" content="https://github.com/gitbrent/">
	<meta name="description" content="SharePoint HOWTOs, SharePoint Web Services, JavaScript SharePoint REST Library, JavaScript SharePoint Form Population">
	<title>SpRestLib | JavaScript SharePoint REST / Web Service Library | SharePoint Docs and HOWTOs</title>

	<link rel="stylesheet" type="text/css" href="../css/prism-okaidia.min.css">
	<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
	<style>
		.group { min-height: 500px; }
		.group .subgroup { min-height: 200px; width: 90%; margin-bottom: 40px; }
		.group .subgroup h4 { margin-top:30px; }

		.fixed { position: fixed; }

		/* sidebar */
		.bs-docs-sidebar {
		    padding-left: 20px;
		    margin-top: 20px;
		    margin-bottom: 20px;
		}

		/* all links */
		.bs-docs-sidebar .nav>li>a {
		    color: #999;
		    border-left: 2px solid transparent;
		    padding: 4px 20px;
		    font-size: 13px;
		    font-weight: 400;
		}

		/* nested links */
		.bs-docs-sidebar .nav .nav>li>a {
		    padding-top: 1px;
		    padding-bottom: 1px;
		    padding-left: 30px;
		    font-size: 12px;
		}

		/* active & hover links */
		.bs-docs-sidebar .nav>.active>a,
		.bs-docs-sidebar .nav>li>a:hover,
		.bs-docs-sidebar .nav>li>a:focus {
		    color: #563d7c;
		    text-decoration: none;
		    background-color: transparent;
		    border-left-color: #563d7c;
		}
		/* all active links */
		.bs-docs-sidebar .nav>.active>a,
		.bs-docs-sidebar .nav>.active:hover>a,
		.bs-docs-sidebar .nav>.active:focus>a {
		    font-weight: 700;
		}
		/* nested active links */
		.bs-docs-sidebar .nav .nav>.active>a,
		.bs-docs-sidebar .nav .nav>.active:hover>a,
		.bs-docs-sidebar .nav .nav>.active:focus>a {
		    font-weight: 500;
		}

		/* hide inactive nested list */
		.bs-docs-sidebar .nav ul.nav {
		    display: none;
		}
		/* show active nested list */
		.bs-docs-sidebar .nav>.active>ul.nav {
		    display: block;
		}

		/*Header formatting */
		.MainContent {
		    margin-top: 50px;
		}
		.group, .subgroup {
		    padding-top: 50px;
		    margin-top: -50px;
		}
		/* ===== */
		.result > pre { overflow-x: scroll; }
		.result > pre code { white-space: pre !important; }

		.navbar a { color: white; }
		.nav>li>a:hover, .nav>li>a:focus, .navbar .active { background: #363636; }
	</style>

	<script src="../js/jquery.js"></script>
	<script src="../js/bootstrap.min.js"></script>
	<script src="../js/prism.min.js"></script>
	<script>
		$(document).ready(function(){
			$('body').scrollspy({
			    target: '.bs-docs-sidebar',
			    offset: 40
			});
		});
	</script>

	<!-- vvv ANALYTICS vvv -->
	<!--
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-75147115-3', 'auto');
		ga('send', 'pageview');
	</script>
	-->
	<!-- ^^^ ANALYTICS ^^^ -->
</head>
<body>
	<!-- Top Navbar -->
	<div class="navbar navbar navbar-fixed-top" style="background-image:url(../images/slider-bg.jpg)">
	    <div class="container">
	        <div class="navbar-header">
	            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	                <span class="icon-bar"></span>
	                <span class="icon-bar"></span>
	                <span class="icon-bar"></span>
	            </button>
				<a class="navbar-brand" href="https://github.com/gitbrent/SpRestLib" target="_blank" title="Visit GitHub Project Page">GitHub Page</a>
	        </div>
	        <div class="collapse navbar-collapse">
	            <ul class="nav navbar-nav">
	                <li>
						<a href="../index.html" title="SharePoint Library Homepage">SpRestLib Homepage</a>
	                </li>
	                <li class="active">
						<a href="#" title="SharePoint Library Code Samples">SpRestLib Documentation</a>
	                </li>
	            </ul>
	        </div>
	    </div>
	</div>

	<!-- Main Content -->
	<div class="row MainContent">
	    <!--Side Nav Bar -->
	    <nav class="col-xs-2 bs-docs-sidebar">
	        <ul id="sidebar" class="nav nav-stacked fixed">
				<li>
	                <a href="#Group0">Introduction</a>
	                <ul class="nav nav-stacked">
	                    <li><a href="#Group0Sub1">Library Setup</a></li>
	                    <li><a href="#Group0Sub2">Asyncronous Calls</a></li>
	                </ul>
	            </li>
	            <li>
	                <a href="#GroupA">List Item Methods</a>
	                <ul class="nav nav-stacked">
	                    <li><a href="#GroupASub1">Get Items</a></li>
	                    <li><a href="#GroupASub2">Create Items</a></li>
						<li><a href="#GroupASub3">Update Items</a></li>
						<li><a href="#GroupASub4">Delete Items</a></li>
						<li><a href="#GroupASub5">Recycle Items</a></li>
	                </ul>
	            </li>
				<li>
	                <a href="#GroupB">List Utility Methods</a>
	                <ul class="nav nav-stacked">
						<li><a href="#GroupBSub1">List Info</a></li>
						<li><a href="#GroupBSub2">List Column Info</a></li>
	                </ul>
	            </li>
	            <li>
	                <a href="#GroupC">User/Group Methods</a>
	                <ul class="nav nav-stacked">
	                    <li><a href="#GroupCSub1">Get User</a></li>
	                    <li><a href="#GroupCSub2">Get User Groups</a></li>
	                </ul>
	            </li>
	            <li>
	                <a href="#GroupD">REST Methods</a>
	                <ul class="nav nav-stacked">
	                    <li><a href="#GroupDSub1">REST API Calls</a></li>
	                </ul>
	            </li>
				<li>
	                <a href="#GroupE">HTML Form Binding</a>
	                <ul class="nav nav-stacked">
						<li><a href="#GroupESub1">Static Elements</a></li>
						<li><a href="#GroupESub2">Select Elements</a></li>
	                    <li><a href="#GroupESub3">Table Elements</a></li>
	                </ul>
	            </li>
	        </ul>

			<img src="../images/SpRestLib_OReilly_Book_Nutshell-150.png" class="hidden-xs hidden-sm" style="position:fixed; bottom:10px; left:10px;">
	    </nav>

	    <!--Main Content -->
	    <div class="col-xs-10">
			<section id="Group0" class="group">
	            <h2>Introduction</h2>

				<h4>SpRestLib is a jQuery library for SharePoint 2013+ that abstracts SharePoint Web Service/REST functionality into a lightweight API.</h4>

	            <div id="Group0Sub1" class="subgroup">
					<h3>Library Setup</h3>

					<h4>Client-Side</h4>
					<div style="margin-left:30px;">
					<h5>Include Local Scripts</h5>
<pre><code class="language-html">&lt;script lang="javascript" src="https://yourhost.com/subsite/SiteAssets/js/jquery.min.js"&gt;&lt;/script&gt;
&lt;script lang="javascript" src="https://yourhost.com/subsite/SiteAssets/js/sprestlib.js"&gt;&lt;/script&gt;
</code></pre>
<i style="color:#c7c7c7">IE11 support requires you include a Promises polyfill as well (one is included in the 'libs' folder)</i>

					<h5>Include Bundle Script</h5>
					<pre><code class="language-html">&lt;script lang="javascript" src="https://yourhost.com/subsite/SiteAssets/js/sprestlib.bundle.js"&gt;&lt;/script&gt;</code></pre>
					<i style="color:#c7c7c7">Bundle includes all required libraries (SpRestLib + jQuery and Promises)</i>

					<h5>Install With Bower</h5>
					<pre><code class="language-bash">bower install sprestlib</code></pre>
</div>
					<h4>Node.js</h4>
					<div style="margin:0 0 30px 30px;">
<pre><code class="language-javascript">npm install sprestlib
var sprLib = require("sprestlib");
</code></pre>
					</div>
				</div>

	            <div id="Group0Sub2" class="subgroup">
					<h3>Asyncronous Calls</h3>
					<h4>Promises replace Callbacks</h4>
					<h5>All of the SpRestLib methods return <a href="http://www.datchley.name/es6-promises/">JavaScript Promises</a>,
						which provide two main benefits:</h5>
					<ol>
						<li>No more callback functions</li>
						<li>No more managing async operations</li>
					</ol>
					<p>
						If you're unfamiliar with the new <a href="http://www.datchley.name/es6-promises/">ES6 Promise</a> functionality,
						you will want to a moment to read more about them. They offer a whole new paradigm for dealing with asynchronous operations.
					</p>
					<p>
						All major browsers and Node.js now fully support ES6 Promises, and they're the reason for all of the <code>.then()</code> code below.
					</p>
					<div style="background:#fffccc; padding:20px;">
						<h4 style="margin-top:auto">Short Version: Async Promise Results Make Your Life Better and Easier</h4>
						Asyncronous operations return Promises which can be chained together and will execute only after the
						previous asyncronous operation completes, or they can be grouped to run at once then advance all of them are completed.
					</p>
				</div>
			</section>

			<!-- ============================= -->
			<!-- List and Library Item Methods -->
			<!-- ============================= -->
	        <section id="GroupA" class="group">
	            <h2>List and Library Item Methods</h2>
				NOTES:
				<ul>
					<li><code>__metadata</code> is always included in results to enable easy chaining of operations (<code>__metadata.type</code> is required for CRUD ops)</li>
					<li>The default max items returned by SharePoint 2013+ is 100 - SpRestLib's default is 1000</li>
					<li>Either List Name or List GUID can be used</li>
					<li>Results are an array of item objects</li>
				</ul>

	            <div id="GroupASub1" class="subgroup">
	                <h3>Get Items</h3>
					<div>

<h4>Passing a simple array of column names will return the first 1,000 items</h4>
<pre><code class="language-javascript">sprLib.list('Employees')
.getItems(
    ['Id', 'Name', 'Badge_x0020_Number']
)
.then(function(arrData){ console.table(arrData) })
.catch(function(errMsg){ console.error(errMsg) });
</code></pre>

<h4>Results</h4>
<div class="result">
<pre><code>.------------------------------------------------------------------------------------------.
|   __metadata    | Id  |    Name     | Badge_x0020_Number |   Hire_x0020_Date    | Salary |
|-----------------|-----|-------------|--------------------|----------------------|--------|
| [object Object] | 287 | Bob Ross    |            1496450 | 1986-06-02T06:00:00Z | 101000 |
| [object Object] | 291 | Hal Jordan  |            1496451 | 2017-06-02T06:00:00Z | 125000 |
| [object Object] | 292 | Barry Allen |            1496452 | 2010-12-25T06:00:00Z | 175000 |
'------------------------------------------------------------------------------------------'
</code></pre>
</div>

<h4>Utilize <code>query*</code> parameters to filter, sort, or set max items</h4>
<pre><code class="language-javascript">sprLib.list('Employees').getItems({
    listCols: ['Id', 'Name', 'Badge_x0020_Number'],
    queryFilter:  'Salary gt 100000',
    queryOrderby: 'Hire_x0020_Date',
    queryLimit:   10
})
.then(function(arrData){ console.table(arrData) })
.catch(function(errMsg){ console.error(errMsg) });
</code></pre>

<h4>Utilize <code>listCols</code> and <code>query*</code> parameters for more complicated operations like filtering</h4>
<ul>
	<li>Using <code>listCols</code> option to name our columns</li>
	<li>Using <code>dataFunc</code> option to return a generate a dynamic value (create links, etc.)</li>
	<li>Using query options: filter, order, limit</li>
</ul>
<pre><code class="language-javascript">sprLib.list('Employees').getItems({
    listCols: {
		id:       { dataName:'Id'                 },
        empName:  { dataName:'Name'               },
        badgeNum: { dataName:'Badge_x0020_Number' },
        editLink: { dataFunc:function(objItem){ return '&lt;a href="../DispForm.aspx?ID='+objItem.Id +'"&gt;View Item&lt;/a&gt;' } }
    },
    queryFilter:  'Salary gt 100000',
    queryOrderby: 'Hire_x0020_Date',
    queryLimit:   10
})
.then(function(arrData){ console.table(arrData) })
.catch(function(errMsg){ console.error(errMsg) });
</code></pre>

<h4>Results</h4>
<div class="result">
<pre><code>.--------------------------------------------------------------------------------------------------.
|   __metadata    | id  |   empName   | badgeNum |                    editLink                     |
|-----------------|-----|-------------|----------|-------------------------------------------------|
| [object Object] | 287 | Bob Ross    |  1496450 | &lt;a href="../DispForm.aspx?ID=287"&gt;View Item&lt;/a&gt; |
| [object Object] | 291 | Hal Jordan  |  1496451 | &lt;a href="../DispForm.aspx?ID=291"&gt;View Item&lt;/a&gt; |
| [object Object] | 292 | Barry Allen |  1496452 | &lt;a href="../DispForm.aspx?ID=292"&gt;View Item&lt;/a&gt; |
'--------------------------------------------------------------------------------------------------'
</code></pre>
</div>
					</div>

	            </div>
	            <div id="GroupASub2" class="subgroup">
	                <h3>Create Items</h3>
					<div>
<pre><code class="language-javascript">sprLib.list('Employees')
.create({ Name:'Marty McFly', Badge_x0020_Number:12345, Hire_x0020_Date:new Date() })
.then(function(objItem){ console.log('New Item:'); console.table(objItem); })
.catch(function(strErr){ console.error(strErr); });
</code></pre>
					</div>
				</div>
				<div id="GroupASub3" class="subgroup">
	                <h3>Update Items</h3>
					<div>
<pre><code class="language-javascript">sprLib.list('Employees')
.update({ Name:'Marty "Nobody call me chicken" McFly' })
.then(function(objItem){ console.log('Updated Item:'); console.table(objItem); })
.catch(function(strErr){ console.error(strErr); });
</code></pre>
					</div>
				</div>
				<div id="GroupASub4" class="subgroup">
	                <h3>Delete Items</h3>
					Permanently deletes an item (bypasses Recycle Bin)
					<div>
<pre><code class="language-javascript">sprLib.list(listName).delete(item)
.then(function(intId){ console.log('Item #'+intId+' was deleted.') })
</code></pre>
					</div>
				</div>
				<div id="GroupASub5" class="subgroup">
	                <h3>Recycle Items</h3>
					Send the item to the site Recycle Bin (fully recoverable)
					<div>
<pre><code class="language-javascript">sprLib.list(listName).recycle(item)
.then(function(intId){ console.log('Item #'+intId+' was recycled.') })
</code></pre>
					</div>
				</div>
	        </section>

	        <section id="GroupB" class="group">
	            <h2>List and Library Utility Methods</h2>
				<div id="GroupBSub1" class="subgroup">
	                <h3>List Properties</h3>
					<h4>Returns the List/Library GUID, and other useful metadata about the List itself.</h4>

					<div>
						<code>sprLib.list(listName).info()</code> - Returns information about the list (GUID, numberOfItems, etc.)
					</div>
				</div>
				<div id="GroupBSub2" class="subgroup">
	                <h3>Column Info</h3>

					<h4>HowTo Get List/Library Column Information</h4>
					<h5>Find metadata about each column in a List/Library including datatype, uniqueness, max length, default value, etc.</h5>
<pre><code class="language-javascript">sprLib.list('Employees').cols()
.then(function(data){ console.table(data) });
</code></pre>

<h4>Results</h4>
<div class="result">
<pre><code>.---------------------------------------------------------------------------------------------------------------------------------------------------------.
|       dispName        |          dataName           |  dataType   | isAppend | isNumPct | isReadOnly | isRequired | isUnique | defaultValue | maxLength |
|-----------------------|-----------------------------|-------------|----------|----------|------------|------------|----------|--------------|-----------|
| ID                    | ID                          | Counter     | false    | false    | true       | false      | false    | null         | null      |
| Title                 | Title                       | Text        | false    | false    | false      | false      | false    | null         |       255 |
| Name                  | Name                        | Text        | false    | false    | false      | true       | false    | null         |       255 |
| Manager               | Manager                     | User        | false    | false    | false      | true       | false    | null         | null      |
| Badge Number          | Badge_x0020_Number          | Number      | false    | false    | false      | false      | false    | null         | null      |
| Job Grade             | Job_x0020_Grade             | Lookup      | false    | false    | false      | false      | false    | null         | null      |
| Hire Date             | Hire_x0020_Date             | DateTime    | false    | false    | false      | false      | false    | null         | null      |
| Salary                | Salary                      | Currency    | false    | false    | false      | false      | false    | null         | null      |
| Extension             | Extension                   | Number      | false    | false    | false      | false      | false    | null         | null      |
| Departments Supported | Departments_x0020_Supported | LookupMulti | false    | false    | false      | false      | false    | null         | null      |
| Comments              | Comments                    | Note        | false    | false    | false      | false      | false    | null         | null      |
| Versioned Comments    | Versioned_x0020_Comments    | Note        | true     | false    | false      | false      | false    | null         | null      |
| Utilization Pct       | Utilization_x0020_Pct       | Number      | false    | true     | false      | false      | false    | null         | null      |
| Active?               | Active_x003f_               | Boolean     | false    | false    | false      | false      | false    | 1            | null      |
| CalcCol               | CalcCol                     | Calculated  | false    | false    | true       | false      | false    | null         | null      |
'---------------------------------------------------------------------------------------------------------------------------------------------------------'
</code></pre>
</div>
				</div>
	        </section>

	        <section id="GroupC" class="group">
	            <h3>User and Group Methods</h3>
	            <div id="GroupCSub1" class="subgroup">
	                <h4>Get Current User (SP.User)</h4>
Get current user (passing no parameters returns the current user)
<pre><code class="language-javascript">sprLib.user().info()
.then(function(objUser){ console.table(objUser) });
</code></pre>
					<h4>Results</h4>
					<div class="result">
						<div class="result">
<pre><code>.------------------------------------------------------------------------------------------------------------------------------.
|   __metadata    | Id |              LoginName                |   Title   | PrincipalType |       Email         | IsSiteAdmin |
|-----------------|----|---------------------------------------|-----------|---------------|---------------------|-------------|
| [object Object] |  9 | i:0#.f|membership|brent@microsoft.com | Brent Ely |             1 | brent@microsoft.com | true        |
'------------------------------------------------------------------------------------------------------------------------------'
</code></pre>
</div>

					<h4>Get Any User (SP.User)</h4>
Get any user info: Query by <code>id</code>, <code>email</code>, or <code>title</code>
<pre><code class="language-javascript">sprLib.user({ email:'brent@microsoft.com' }).info()
.then(function(objUser){ console.table(objUser) });
</code></pre>
					<h4>Results</h4>
					<div class="result">
<pre><code>.------------------------------------------------------------------------------------------------------------------------------.
|   __metadata    | Id |              LoginName                |   Title   | PrincipalType |       Email         | IsSiteAdmin |
|-----------------|----|---------------------------------------|-----------|---------------|---------------------|-------------|
| [object Object] |  9 | i:0#.f|membership|brent@microsoft.com | Brent Ely |             1 | brent@microsoft.com | true        |
'------------------------------------------------------------------------------------------------------------------------------'
</code></pre>
	            </div>
	            <div id="GroupCSub2" class="subgroup">
					<h4>Get Current User Groups (SP.Group)</h4>
Get current user's groups (passing no parameters returns the current user)
<pre><code class="language-javascript">sprLib.user().groups()
.then(function(arrGroups){ console.table(arrGroups) });
</code></pre>
					<h4>Results</h4>
					<div class="result">
<pre><code>.------------------------.
| Id |       Title       |
|----|-------------------|
|  1 | Dev Site Owners   |
|  6 | Dev Site Members  |
|  9 | Dev Site Visitors |
'------------------------'
</code></pre>
	            </div>
	        </section>

			<section id="GroupD" class="group">
	            <h3>REST API Calls</h3>
	            <div id="GroupDSub1" class="subgroup">
	                <h4>Utliize SharePoint REST endpoints</h4>

					<p>Query any of the dozens of available SharePoint Endpoints to gather site/list info, create Lists, column, subsites, you name it.</p>

					<h4>Query all site Lists/Libraries</h4>
<pre><code class="language-javascript">sprLib.rest({ url:'/_api/web/lists?$select=BaseType,ItemCount,Title' })
.then(function(arrResults){ console.table(arrResults) });
</code></pre>
					<h4>Results</h4>
					<div class="result">
<pre><code>.----------------------------------------------------------.
| BaseType | ItemCount |               Title               |
|----------|-----------|-----------------------------------|
|        0 |         0 | appdata                           |
|        1 |         0 | appfiles                          |
|        0 |        18 | Composed Looks                    |
|        0 |         0 | Content type publishing error log |
|        1 |         0 | Converted Forms                   |
|        0 |        10 | Departments                       |
|        1 |        25 | Documents                         |
|        0 |        25 | Employees                         |
|        0 |         4 | Job Grades                        |
|        1 |         1 | List Template Gallery             |
|        1 |         3 | Maintenance Log Library           |
|        1 |       225 | Master Page Gallery               |
|        0 |         2 | MicroFeed                         |
|        1 |        58 | Site Assets                       |
|        1 |         7 | Site Pages                        |
|        1 |         0 | Solution Gallery                  |
|        1 |         5 | Style Library                     |
|        1 |        41 | Theme Gallery                     |
|        1 |        71 | Web Part Gallery                  |
|        1 |         0 | wfpub                             |
'----------------------------------------------------------'
</code></pre>

<h4>Create a new List column</h4>
<pre><code class="language-javascript">sprLib.rest({
    url:  "_api/web/lists/getbytitle('Employees')/fields",
    type: "POST",
    data: "{'__metadata':{'type':'SP.FieldDateTime'}, 'FieldTypeKind':4, 'Title':'Bonus Date', 'DisplayFormat':1 }"
})
.then(function(){ console.log("New column created!"); })
</code></pre>

	            </div>
	        </section>

			<section id="GroupE" class="group">
	            <h3>Form Binding/Population</h3>
				<p>Quickly populate form elements with data-binding similar to Angular</p>

	            <div id="GroupESub1" class="subgroup">
	                <h4>Static Elements</h4>
					<h5>Place a list item inside a static element (<code>&lt;span&gt;</code>, <code>&lt;div&gt;</code> etc.)</h5>
<pre><code class="language-html">&lt;span data-sprlib='{ "list":"Employees", "value":"Name", "filter":{"col":"Name", "op":"eq", "val":"Brent Ely"} }'&gt;&lt;/span&gt;
</code></pre>
	            </div>
	            <div id="GroupESub2" class="subgroup">
	                <h4>Select Elements</h4>
					<h5>Easily populate a <code>&lt;select&gt;</code> dropdown with values from a List (both the text and value can be specified)</h5>
<pre><code class="language-html">&lt;select data-sprlib='{ "list":"Employees", "value":"Id", "text":"Name" }'&gt;&lt;/select&gt;</code></pre>
	            </div>
				<div id="GroupESub3" class="subgroup">
	                <h4>Table Elements</h4>
					<h5>Populate a <code>&lt;table&gt;</code> rows with values from a List</h5>
<pre><code class="language-html">&lt;table data-sprlib='{ "foreach": {"list":"Employees", "filter":{"col":"Badge_x0020_Number", "op":"eq", "val":1234}}, "options":{"showBusySpinner":true} }'&gt;
</code></pre>

					<h5>Populate a <code>&lt;table&gt;</code> <code>&lt;tbody&gt;</code> rows with values from a List</h5>
<pre><code class="language-html">&lt;tbody data-sprlib='{ "foreach": {"list":"Employees", "cols":["Name","Utilization_x0020_Pct"] } }'&gt;&lt;/tbody&gt;
</code></pre>

	            </div>
	        </section>
	    </div>
	</div>
</body>
</html>
