<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
	<meta name="author" content="https://github.com/gitbrent/">
	<meta name="description" content="SharePoint HOWTOs, SharePoint Web Services, JavaScript SharePoint REST Library, JavaScript SharePoint Form Population">
	<title>SpRestLib | JavaScript SharePoint REST / Web Service Library | SharePoint Docs and HOWTOs</title>

	<link rel="stylesheet" type="text/css" href="../css/prism-okaidia.min.css">
	<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
	<style>
		.group { min-height: 500px; }
		.group .subgroup { min-height: 200px; width: 90%; margin-bottom: 40px; }
		.group .subgroup h4 { margin-top:30px; }

		.fixed { position: fixed; }

		/* sidebar */
		.bs-docs-sidebar {
		    padding-left: 20px;
		    margin-top: 20px;
		    margin-bottom: 20px;
		}

		/* all links */
		.bs-docs-sidebar .nav>li>a {
		    color: #999;
		    border-left: 2px solid transparent;
		    padding: 4px 20px;
		    font-size: 13px;
		    font-weight: 400;
		}

		/* nested links */
		.bs-docs-sidebar .nav .nav>li>a {
		    padding-top: 1px;
		    padding-bottom: 1px;
		    padding-left: 30px;
		    font-size: 12px;
		}

		/* active & hover links */
		.bs-docs-sidebar .nav>.active>a,
		.bs-docs-sidebar .nav>li>a:hover,
		.bs-docs-sidebar .nav>li>a:focus {
		    color: #563d7c;
		    text-decoration: none;
		    background-color: transparent;
		    border-left-color: #563d7c;
		}
		/* all active links */
		.bs-docs-sidebar .nav>.active>a,
		.bs-docs-sidebar .nav>.active:hover>a,
		.bs-docs-sidebar .nav>.active:focus>a {
		    font-weight: 700;
		}
		/* nested active links */
		.bs-docs-sidebar .nav .nav>.active>a,
		.bs-docs-sidebar .nav .nav>.active:hover>a,
		.bs-docs-sidebar .nav .nav>.active:focus>a {
		    font-weight: 500;
		}

		/* hide inactive nested list */
		.bs-docs-sidebar .nav ul.nav {
		    display: none;
		}
		/* show active nested list */
		.bs-docs-sidebar .nav>.active>ul.nav {
		    display: block;
		}

		/*Header formatting */
		.MainContent {
		    margin-top: 50px;
		}
		.group, .subgroup {
		    padding-top: 50px;
		    margin-top: -50px;
		}
	</style>

	<script src="../js/jquery.js"></script>
	<script src="../js/bootstrap.min.js"></script>
	<script src="../js/prism.min.js"></script>
	<script>
		$(document).ready(function(){
			$('body').scrollspy({
			    target: '.bs-docs-sidebar',
			    offset: 40
			});
		});
	</script>

	<!-- vvv ANALYTICS vvv -->
	<!--
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-75147115-3', 'auto');
		ga('send', 'pageview');
	</script>
	-->
	<!-- ^^^ ANALYTICS ^^^ -->
</head>
<body>
	<!-- Top Navbar -->
	<div class="navbar navbar-inverse navbar-fixed-top">
	    <div class="container">
	        <div class="navbar-header">
	            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	                <span class="icon-bar"></span>
	                <span class="icon-bar"></span>
	                <span class="icon-bar"></span>
	            </button>
				<a class="navbar-brand" href="https://github.com/gitbrent/SpRestLib#sprestlib">Full Documentation</a>
	        </div>
	        <div class="collapse navbar-collapse">
	            <ul class="nav navbar-nav">
	                <li>
						<a href="../index.html">SharePoint Library Home</a>
	                </li>
	                <li class="active">
						<a href="#">SharePoint Library Examples</a>
	                </li>
	            </ul>
	        </div>
	    </div>
	</div>

	<!-- Main Content -->
	<div class="row MainContent">
	    <!--Side Nav Bar -->
	    <nav class="col-xs-3 bs-docs-sidebar">
	        <ul id="sidebar" class="nav nav-stacked fixed">
				<li>
	                <a href="#Group0">Introduction</a>
	                <ul class="nav nav-stacked">
	                    <li><a href="#Group0Sub1">Library Setup</a></li>
	                    <li><a href="#Group0Sub2">Asyncronous Calls</a></li>
	                </ul>
	            </li>
	            <li>
	                <a href="#GroupA">List and Library Item Methods</a>
	                <ul class="nav nav-stacked">
	                    <li><a href="#GroupASub1">Get Items</a></li>
	                    <li><a href="#GroupASub2">Create Items</a></li>
						<li><a href="#GroupASub3">Update Items</a></li>
						<li><a href="#GroupASub4">Delete Items</a></li>
						<li><a href="#GroupASub5">Recycle Items</a></li>
	                </ul>
	            </li>
				<li>
	                <a href="#GroupB">List and Library Utility Methods</a>
	                <ul class="nav nav-stacked">
						<li><a href="#GroupBSub1">List Info</a></li>
						<li><a href="#GroupBSub2">List Column Info</a></li>
	                </ul>
	            </li>
	            <li>
	                <a href="#GroupC">User and Group Methods</a>
	                <ul class="nav nav-stacked">
	                    <li><a href="#GroupCSub1">Get User</a></li>
	                    <li><a href="#GroupCSub2">Get User Groups</a></li>
	                </ul>
	            </li>
	            <li>
	                <a href="#GroupD">REST Methods</a>
	                <ul class="nav nav-stacked">
	                    <li><a href="#GroupDSub1">REST API Calls</a></li>
	                    <li><a href="#GroupDSub2">Sub-Group 2</a></li>
	                </ul>
	            </li>
				<li>
	                <a href="#GroupE">Form Binding/Population</a>
	                <ul class="nav nav-stacked">
	                    <li><a href="#GroupESub1">Sub-Group 1</a></li>
	                    <li><a href="#GroupESub2">Sub-Group 2</a></li>
	                </ul>
	            </li>
	        </ul>
	    </nav>

	    <!--Main Content -->
	    <div class="col-xs-9">
			<section id="Group0" class="group">
	            <h2>Introduction</h2>

				<h4>SpRestLib is a jQuery library that abstracts SharePoint Web Service/REST fucntionality into a lightweight API.</h4>

	            <div id="Group0Sub1" class="subgroup">
					<h3>Library Setup</h3>

					<h4>Client-Side</h4>
					<p>SpRestLib utilizes the jQuery library - include it before sprestlib. That's it!</p>
<pre><code class="language-html">&lt;script lang="javascript" src="https://code.jquery.com/jquery-3.1.1.slim.min.js"&gt;&lt;/script&gt;
&lt;script lang="javascript" src="https://yourhost.com/subsite/SiteAssets/js/sprestlib.js"&gt;&lt;/script&gt;
</code></pre>
					<p><b>NOTE</b>: IE11 support requires a Promises polyfill as well (included in the <code>libs</code> folder)</p>

					<h4>Node</h4>
<pre><code class="language-javascript">npm install sprestlib
var sprLib = require("sprestlib");
</code></pre>
				</div>

	            <div id="Group0Sub2" class="subgroup">
					<h3>Asyncronous Calls</h3>
					<p>All of the SpRestLib methods return JavaScript Promises, which provide two main benefits:</p>
					<ul>
						<li>No more callback functions</li>
						<li>No more managing async operations</li>
					</ul>
					<p>
						If you're unfamiliar with the new <a href="http://www.datchley.name/es6-promises/">ES6 Promise</a> functionality,
						you may want to the a moment to read more about them. They really are a game changer for those of us who deal with asynchronous operations.
					</p>
					<p>
						All major browsers (and Node.js) now fully support ES6 Promises, and they're why all the <code>.then()</code> code below.
					</p>
					<div style="background:#fffccc; padding:20px;">
						<div><b>tl;dr;</b></div>
						Promises can be chained together and will execute only after the previous asyncronous operation completes
					</p>
				</div>
			</section>

			<!-- ============================= -->
			<!-- List and Library Item Methods -->
			<!-- ============================= -->
	        <section id="GroupA" class="group">
	            <h2>List and Library Item Methods</h2>
				NOTES:
				<ul>
					<li><code>__metadata</code> is always included in results to enable easy chaining of operations (<code>__metadata.type</code> is required for CRUD ops)</li>
					<li>The default max items returned by SharePoint 2013+ is 100 - SpRestLib's default is 1000</li>
					<li>Either List Name or List GUID can be used</li>
					<li>Results are an array of item objects</li>
				</ul>


	            <div id="GroupASub1" class="subgroup">
	                <h3>Get Items</h3>
					<div>

<h4>Passing a simple array of column names will return the first 1,000 items</h4>
<pre><code class="language-javascript">sprLib.list('Employees')
.getItems(
    ['Id', 'Name', 'Badge_x0020_Number']
)
.then(function(arrData){ console.table(arrData) })
.catch(function(errMsg){ console.error(errMsg) });
</code></pre>

<h4>Results</h4>
<pre><code>.------------------------------------------------------------------------------------------.
|   __metadata    | Id  |    Name     | Badge_x0020_Number |   Hire_x0020_Date    | Salary |
|-----------------|-----|-------------|--------------------|----------------------|--------|
| [object Object] | 287 | Bob Ross    |            1496450 | 1986-06-02T06:00:00Z | 101000 |
| [object Object] | 291 | Hal Jordan  |            1496451 | 2017-06-02T06:00:00Z | 125000 |
| [object Object] | 292 | Barry Allen |            1496452 | 2010-12-25T06:00:00Z | 175000 |
'------------------------------------------------------------------------------------------'
</code></pre>

<h4>Utilize <code>query*</code> parameters to filter, sort, or set max items</h4>
<pre><code class="language-javascript">sprLib.list('Employees').getItems({
    listCols: ['Id', 'Name', 'Badge_x0020_Number'],
    queryFilter:  'Salary gt 100000',
    queryOrderby: 'Hire_x0020_Date',
    queryLimit:   10
})
.then(function(arrData){ console.table(arrData) })
.catch(function(errMsg){ console.error(errMsg) });
</code></pre>

<h4>Utilize <code>listCols</code> and <code>query*</code> parameters for more complicated operations like filtering</h4>
<ul>
	<li>Using <code>listCols</code> option to name our columns</li>
	<li>Using <code>dataFunc</code> option to return a calculated value</li>
	<li>Using query options: filter, order, limit</li>
</ul>
<pre><code class="language-javascript">sprLib.list('Employees').getItems({
    listCols: {
		id:       { dataName:'Id'                 },
        empName:  { dataName:'Name'               },
        badgeNum: { dataName:'Badge_x0020_Number' },
        editLink: { dataFunc:function(objItem){ return '<a href="../DispForm.aspx?ID='+objItem.Id +'">View Item</a>' } }
    },
    queryFilter:  'Salary gt 100000',
    queryOrderby: 'Hire_x0020_Date',
    queryLimit:   10
})
.then(function(arrData){ console.table(arrData) })
.catch(function(errMsg){ console.error(errMsg) });
</code></pre>

<h4>Results</h4>
<pre><code>.--------------------------------------------------------------------------------------------------------.
|   __metadata    | id  |   empName   | badgeNum |                    editLink                     | Id  |
|-----------------|-----|-------------|----------|-------------------------------------------------|-----|
| [object Object] | 287 | Bob Ross    |  1496450 | &lt;a href="../DispForm.aspx?ID=287"&gt;View Item&lt;/a&gt; | 287 |
| [object Object] | 291 | Hal Jorden  |  1496451 | &lt;a href="../DispForm.aspx?ID=291"&gt;View Item&lt;/a&gt; | 291 |
| [object Object] | 292 | Barry Allen |  1496452 | &lt;a href="../DispForm.aspx?ID=292"&gt;View Item&lt;/a&gt; | 292 |
'--------------------------------------------------------------------------------------------------------'
</code></pre>
					</div>

	            </div>
	            <div id="GroupASub2" class="subgroup">
	                <h3>Create Items</h3>
					<div>
<pre><code class="language-javascript">sprLib.list('Employees')
sprLib.list('Employees')
.create({ Name:'Marty McFly', Badge_x0020_Number:12345, Hire_x0020_Date:new Date() })
.then(function(objItem){ console.log('New Item:'); console.table(objItem); })
.catch(function(strErr){ console.error(strErr); });
</code></pre>
					</div>
				</div>
				<div id="GroupASub3" class="subgroup">
	                <h3>Update Items</h3>
					<div>
						<code>sprLib.list(listName).update(item)</code> - Update the existing item using the data provided
					</div>
				</div>
				<div id="GroupASub4" class="subgroup">
	                <h3>Delete Items</h3>
					<div>
						<code>sprLib.list(listName).delete(item)</code> - Delete the item (permanently delete)
					</div>
				</div>
				<div id="GroupASub5" class="subgroup">
	                <h3>Recycle Items</h3>
					<div>
						<code>sprLib.list(listName).recycle(item)</code> - Recycle the item (move into the Recycle Bin)
					</div>
				</div>
	        </section>

	        <section id="GroupB" class="group">
	            <h3>List and Library Utility Methods</h3>
				<div id="GroupBSub1" class="subgroup">
	                <h4>List Info</h4>
					<div>
						<code>sprLib.list(listName).info()</code> - Returns information about the list (GUID, numberOfItems, etc.)
					</div>
				</div>
				<div id="GroupBSub2" class="subgroup">
	                <h4>Column Info</h4>

<h4>Get information about a List's columns</h4>
<pre><code class="language-javascript">sprLib.list('Employees').cols()
.then(function(data){ console.table(data) });
</code></pre>

<h4>Results</h4>
<pre><code>.--------------------------------------------------------------------------------------------------------------------------------------------------.
|      dispName      |         dataName         |  dataType  | isAppend | isNumPct | isReadOnly | isRequired | isUnique | defaultValue | maxLength |
|--------------------|--------------------------|------------|----------|----------|------------|------------|----------|--------------|-----------|
| Name               | Name                     | Text       | false    | false    | false      | false      | false    |              |       255 |
| Badge Number       | Badge_x0020_Number       | Number     | false    | false    | false      | true       | true     |              |           |
| Hire Date          | Hire_x0020_Date          | DateTime   | false    | false    | false      | false      | false    |              |           |
| ID                 | ID                       | Counter    | false    | false    | true       | false      | false    |              |           |
'--------------------------------------------------------------------------------------------------------------------------------------------------'
</code></pre>
					<div>
						<code>sprLib.list(listName).cols()</code> - Returns an array of column objects with useful info (name, datatype, etc.)
					</div>
				</div>
	        </section>

	        <section id="GroupC" class="group">
	            <h3>User and Group Methods</h3>
	            <div id="GroupCSub1" class="subgroup">
	                <h4>Get User</h4>
	            </div>
	            <div id="GroupCSub2" class="subgroup">
	                <h4>Get User Groups</h4>
	            </div>
	        </section>

			<section id="GroupD" class="group">
	            <h3>REST API Calls</h3>
	            <div id="GroupDSub1" class="subgroup">
	                <h4>Group D Sub 1</h4>
	            </div>
	            <div id="GroupDSub2" class="subgroup">
	                <h4>Group D Sub 2</h4>
	            </div>
	        </section>

			<section id="GroupE" class="group">
	            <h3>Form Binding/Population</h3>
	            <div id="GroupESub1" class="subgroup">
	                <h4>Group E Sub 1</h4>
	            </div>
	            <div id="GroupESub2" class="subgroup">
	                <h4>Group E Sub 2</h4>
	            </div>
	        </section>
	    </div>
	</div>
</body>
</html>
